<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Carrito de Tequilas</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #d4af37; /* Gold */
            --secondary-color: #222; /* Dark Gray */
            --text-color: #333;
            --light-text-color: #666;
            --background-color: #f8f8f8;
            --card-background: #fff;
            --button-success: #28a745;
            --button-danger: #dc3545;
            --border-color: #eee;
            --shadow-light: rgba(0,0,0,0.08);
            --shadow-medium: rgba(0,0,0,0.12);
        }

        body {
            font-family: 'Roboto', Arial, sans-serif;
            background: var(--background-color);
            margin: 0;
            line-height: 1.6;
            color: var(--text-color);
        }

        header {
            display: flex;
            align-items: center;
            background: var(--secondary-color);
            color: #fff;
            padding: 16px 40px;
            box-shadow: 0 4px 15px var(--shadow-medium);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            width: 70px;
            margin-right: 24px;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(255,255,255,0.2);
        }

        nav {
            margin-left: auto;
        }

        nav a {
            color: #fff;
            margin: 0 20px;
            text-decoration: none;
            font-weight: 500;
            font-size: 1.05em;
            transition: color 0.3s ease, transform 0.2s ease;
            position: relative;
        }

        nav a:hover {
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        nav a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 0;
            background-color: var(--primary-color);
            transition: width 0.3s ease;
        }

        nav a:hover::after {
            width: 100%;
        }

        .container {
            max-width: 1000px;
            margin: 20px auto;
            background: var(--card-background);
            border-radius: 15px;
            box-shadow: 0 5px 20px var(--shadow-medium);
            padding: 25px;
        }

        h1 {
            font-family: 'Playfair Display', serif;
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 2.5em;
            letter-spacing: 1px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .productos {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            justify-content: center;
            padding: 10px 0;
        }

        .producto {
            background: #fdfcf9;
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 4px 15px var(--shadow-light);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }

        .producto:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .producto img {
            max-width: 90%;
            height: 180px;
            object-fit: contain;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .producto h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5em;
            color: var(--secondary-color);
            margin-bottom: 10px;
            line-height: 1.3;
        }

        .producto p {
            color: var(--light-text-color);
            font-size: 0.9em;
            margin-bottom: 8px;
            flex-grow: 1;
        }

        .producto .precio-actual {
            font-size: 1.25em;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: block;
        }

        .producto .cantidad-controls {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            gap: 15px;
            margin-bottom: 15px;
        }

        .producto .cantidad-controls button {
            background: var(--button-success);
            color: white;
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            transition: background 0.3s ease, transform 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .producto .cantidad-controls button:hover {
            background: #218838;
            transform: scale(1.1);
        }

        .producto .cantidad {
            font-size: 1.3em;
            font-weight: 700;
            color: var(--text-color);
            min-width: 30px;
            text-align: center;
        }

        .producto .subtotal {
            font-size: 1.2em;
            font-weight: 700;
            color: #007bff;
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px dashed var(--border-color);
            width: 100%;
        }

        .producto .eliminar-btn {
            background: var(--button-danger);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 18px;
            cursor: pointer;
            font-size: 0.95em;
            font-weight: 600;
            margin-top: 20px;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .producto .eliminar-btn:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .vaciar-carrito {
            display: block;
            width: fit-content;
            margin: 30px auto;
            background: var(--button-danger);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 12px 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background 0.3s ease, transform 0.2s ease;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }

        .vaciar-carrito:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .resumen-carrito {
            text-align: right;
            margin-top: 10px;
            padding: 10px 20px;
            border-top: 1px solid var(--primary-color);
            position: sticky;
            bottom: 0;
            background: var(--card-background);
            border-bottom-left-radius: 15px;
            border-bottom-right-radius: 15px;
            z-index: 900;
            box-shadow: 0 -3px 10px var(--shadow-light);
        }
        
        .resumen-carrito .toggle-resumen-btn {
            display: flex;
            align-items: center;
            justify-content: flex-end;
            cursor: pointer;
            padding: 8px;
            border-radius: 8px;
            transition: background-color 0.2s ease;
            color: var(--secondary-color);
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .resumen-carrito .toggle-resumen-btn:hover {
            background-color: var(--border-color);
        }
        
        .resumen-carrito .toggle-resumen-btn .arrow {
            margin-left: 10px;
            width: 0; 
            height: 0; 
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 10px solid var(--secondary-color);
            transition: transform 0.3s ease;
            transform: rotate(0deg);
        }

        .resumen-carrito.oculto .toggle-resumen-btn .arrow {
            transform: rotate(180deg);
            border-bottom: 10px solid var(--secondary-color);
        }

        .resumen-carrito .resumen-contenido {
            max-height: 200px;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out, opacity 0.3s ease-in-out;
            opacity: 1;
        }

        .resumen-carrito.oculto .resumen-contenido {
            max-height: 0;
            opacity: 0;
        }

        .resumen-carrito h2 {
            font-family: 'Playfair Display', serif;
            font-size: 1.4em;
            color: var(--secondary-color);
            margin-bottom: 5px;
            letter-spacing: 0.5px;
        }

        .resumen-carrito p {
            font-size: 1.8em;
            font-weight: 700;
            color: var(--button-success);
            margin-bottom: 10px;
        }

        .resumen-carrito button {
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 12px; /* Más redondeado */
            padding: 12px 25px; /* Más grande */
            cursor: pointer;
            font-size: 1.2em; /* Más grande */
            font-weight: 700;
            transition: background 0.3s ease, transform 0.3s ease, box-shadow 0.3s ease; /* Transiciones mejoradas */
            box-shadow: 0 4px 10px rgba(0,0,0,0.25); /* Sombra más pronunciada */
            margin-top: 15px; /* Más espacio */
        }

        .resumen-carrito button:hover {
            background: #b89a2f;
            transform: translateY(-4px); /* Se eleva más al pasar el mouse */
            box-shadow: 0 8px 15px rgba(0,0,0,0.35); /* Sombra más grande al pasar el mouse */
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            header {
                padding: 12px 20px;
            }
            .logo {
                width: 50px;
            }
            nav a {
                margin: 0 10px;
                font-size: 1em;
            }
            .container {
                margin: 20px auto;
                padding: 25px;
            }
            h1 {
                font-size: 2.2em;
            }
            .productos {
                grid-template-columns: 1fr;
            }
            .producto {
                width: auto;
            }
            .resumen-carrito h2 {
                font-size: 1.5em;
            }
            .resumen-carrito p {
                font-size: 2em;
            }
            .resumen-carrito button {
                padding: 12px 20px;
                font-size: 1.1em; /* Mantiene el tamaño para móvil */
            }
        }
    </style>
</head>
<body>
    <header>
        <img src="IMAGENES JOSE CUERVO/JOSE CUERVO LOGO blanco.png" alt="Logo Tequilera Jose Cuervo" class="logo">
        <nav>
            <a href="index.html">Página Principal</a>
            <a href="catalogo.html">Catálogo</a>
            <a href="mixiologia.html">Mixología</a>
            <a href="carrito.html">Carrito</a>
            <a href="ver_pedido.html">Ver Pedido</a>
        </nav>
    </header>

    <div class="container">
        <h1>Tu Carrito</h1>
        <div id="productos-carrito" class="productos">
        </div>

        <button id="vaciar-carrito-btn" class="vaciar-carrito">Vaciar Carrito</button>

        <div id="resumen-carrito" class="resumen-carrito">
            <div id="toggle-resumen-btn" class="toggle-resumen-btn">
                <span>Resumen del Carrito</span>
                <div class="arrow"></div>
            </div>
            <div id="resumen-contenido" class="resumen-contenido">
                <h2>Total del Carrito:</h2>
                <p id="total-carrito">$0.00</p>
                <button id="proceder-compra-btn">Proceder a la Compra</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const productosCarritoDiv = document.getElementById('productos-carrito');
            const totalCarritoSpan = document.getElementById('total-carrito');
            const vaciarCarritoBtn = document.getElementById('vaciar-carrito-btn');
            const procederCompraBtn = document.getElementById('proceder-compra-btn');

            const resumenCarritoDiv = document.getElementById('resumen-carrito');
            const toggleResumenBtn = document.getElementById('toggle-resumen-btn');
            const resumenContenidoDiv = document.getElementById('resumen-contenido');
            if (window.innerWidth <= 768) {
                resumenCarritoDiv.classList.add('oculto');
            }

            const allProducts = [
                {
                    id: 1,
                    name: 'Maestro Doble',
                    description: 'Tequila Maestro Doble de Jose Cuervo. Un tequila ultra-premium 100% de agave azul.',
                    image: "/IMAGENES JOSE CUERVO/1800.jpeg",
                    menudeo: 450.00,
                    mayoreo: 400.00,
                    botellasPorCaja: 12
                },
                {
                    id: 2,
                    name: 'Tequila Jose Cuervo Tradicional',
                    description: 'El tequila tradicional de Jose Cuervo, perfecto para margaritas o para tomar solo.',
                    image: "/IMAGENES JOSE CUERVO/1800.jpeg",
                    menudeo: 380.00,
                    mayoreo: 340.00,
                    botellasPorCaja: 12
                },
                {
                    id: 3,
                    name: 'Jose Cuervo Especial',
                    description: 'Tequila Jose Cuervo Especial, un clásico versátil ideal para cocteles.',
                    image: "/IMAGENES JOSE CUERVO/1800.jpeg",
                    menudeo: 320.00,
                    mayoreo: 280.00,
                    botellasPorCaja: 12
                },
                {
                    id: 4,
                    name: 'Tequila 1800',
                    description: 'Tequila 1800, 100% de agave azul, con un sabor suave y complejo.',
                    image: "/IMAGENES JOSE CUERVO/1800.jpeg",
                    menudeo: 550.00,
                    mayoreo: 500.00,
                    botellasPorCaja: 6
                },
            ];

            function obtenerCarrito() {
                return JSON.parse(localStorage.getItem('carrito')) || [];
            }

            function guardarCarrito(carrito) {
                localStorage.setItem('carrito', JSON.stringify(carrito));
            }

            function calcularPrecioUnitarioReal(item) {
                const productoBase = allProducts.find(p => p.id === item.id);
                if (!productoBase) return 0;
                if (item.type === 'menudeo') {
                    return productoBase.menudeo;
                } else if (item.type === 'mayoreo') {
                    return item.price || productoBase.mayoreo;
                }
                return 0;
            }

            function renderizarCarrito() {
                const carrito = obtenerCarrito();
                productosCarritoDiv.innerHTML = '';
                let totalGeneral = 0;

                if (carrito.length === 0) {
                    productosCarritoDiv.innerHTML = '<p style="text-align: center; font-size: 1.2em; color: #555; padding: 30px;">El carrito está vacío. ¡Explora nuestro catálogo para encontrar tu tequila ideal!</p>';
                    totalCarritoSpan.textContent = '$0.00';
                    vaciarCarritoBtn.style.display = 'none';
                    procederCompraBtn.style.display = 'none';
                    return;
                }

                vaciarCarritoBtn.style.display = 'block';
                procederCompraBtn.style.display = 'block';

                carrito.forEach(item => {
                    const productoBase = allProducts.find(p => p.id === item.id);
                    if (!productoBase) return;

                    const precioUnitario = calcularPrecioUnitarioReal(item);
                    let subtotal;
                    let tipoTexto;
                    let precioMostrado;

                    if (item.type === 'menudeo') {
                        subtotal = precioUnitario * item.quantity;
                        tipoTexto = 'Botella (Menudeo)';
                        precioMostrado = `$${precioUnitario.toFixed(2)}`;
                    } else {
                        subtotal = precioUnitario * productoBase.botellasPorCaja * item.quantity;
                        tipoTexto = `Caja (Mayoreo - ${productoBase.botellasPorCaja} botellas/caja)`;
                        precioMostrado = `$${precioUnitario.toFixed(2)} (por botella)`;
                    }
                    
                    totalGeneral += subtotal;

                    const productoDiv = document.createElement('div');
                    productoDiv.className = 'producto';
                    productoDiv.innerHTML = `
                        <img src="${item.image}" alt="${item.name}">
                        <h2>${item.name}</h2>
                        <p>Tipo: ${tipoTexto}</p>
                        <p class="precio-actual">Precio Unitario: ${precioMostrado}</p>
                        <div class="cantidad-controls">
                            <button onclick="cambiarCantidad('${item.cartItemId}', -1)">-</button>
                            <span class="cantidad">${item.quantity}</span>
                            <button onclick="cambiarCantidad('${item.cartItemId}', 1)">+</button>
                        </div>
                        <p class="subtotal">Subtotal: $${subtotal.toFixed(2)}</p>
                        <button class="eliminar-btn" onclick="eliminarDelCarrito('${item.cartItemId}')">Eliminar</button>
                    `;
                    productosCarritoDiv.appendChild(productoDiv);
                });

                totalCarritoSpan.textContent = `$${totalGeneral.toFixed(2)}`;
            }

            window.cambiarCantidad = function(cartItemId, cambio) {
                const carrito = obtenerCarrito();
                const itemIndex = carrito.findIndex(item => item.cartItemId === cartItemId);
                if (itemIndex > -1) {
                    carrito[itemIndex].quantity += cambio;
                    if (carrito[itemIndex].quantity <= 0) {
                        carrito.splice(itemIndex, 1);
                    }
                    guardarCarrito(carrito);
                    renderizarCarrito();
                    actualizarContadorCarritoGlobal();
                }
            };

            window.eliminarDelCarrito = function(cartItemId) {
                if (!confirm('¿Estás seguro de que quieres eliminar este producto del carrito?')) {
                    return;
                }
                let carrito = obtenerCarrito();
                carrito = carrito.filter(item => item.cartItemId !== cartItemId);
                guardarCarrito(carrito);
                renderizarCarrito();
                actualizarContadorCarritoGlobal();
            };

            vaciarCarritoBtn.addEventListener('click', function() {
                if (confirm('¿Estás seguro de que quieres vaciar el carrito? Esta acción no se puede deshacer.')) {
                    localStorage.removeItem('carrito');
                    renderizarCarrito();
                    actualizarContadorCarritoGlobal();
                }
            });

            procederCompraBtn.addEventListener('click', function() {
                const carrito = obtenerCarrito();
                if (carrito.length === 0) {
                    alert('Tu carrito está vacío. Por favor, agrega productos antes de proceder a la compra.');
                    return;
                }
                window.location.href = 'compra.html';
            });
            
            toggleResumenBtn.addEventListener('click', function() {
                resumenCarritoDiv.classList.toggle('oculto');
            });

            function actualizarContadorCarritoGlobal() {
                const carrito = obtenerCarrito();
                const totalItems = carrito.reduce((sum, item) => sum + item.quantity, 0);
                const cartCountElement = document.getElementById('cart-count');
                if (cartCountElement) {
                   cartCountElement.textContent = carrito.length;
                }
            }

            renderizarCarrito();
            actualizarContadorCarritoGlobal();
        });
    </script>
</body>
</html>